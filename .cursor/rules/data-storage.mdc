---
description:
globs:
alwaysApply: false
---
# Data Storage

LocalCA uses a structured file system approach to store certificates, keys, and metadata.

## Storage Structure

- [pkg/storage/](mdc:pkg/storage) - Storage management package
  - File system operations
  - Metadata handling
  - Certificate and key storage
  - Backup and restore functionality

## Directory Structure

- `data/` - Root data directory (configurable)
  - `ca/` - CA certificates and keys
    - `ca.crt` - CA certificate
    - `ca.key` - CA private key (encrypted)
    - `crl.pem` - Certificate Revocation List
  - `certs/` - Issued certificates
    - `<id>/` - Certificate directory by ID
      - `cert.pem` - Certificate
      - `key.pem` - Private key
      - `metadata.json` - Certificate metadata
  - `acme/` - ACME protocol data
    - `accounts/` - ACME accounts
    - `orders/` - Certificate orders
    - `challenges/` - Challenge data
  - `backup/` - Backup storage

## Metadata Storage

Certificate metadata is stored in JSON format and includes:
- Certificate ID
- Common Name
- Subject Alternative Names
- Issuance date
- Expiration date
- Serial number
- Certificate type
- Revocation status
- Additional custom fields

## Storage Operations

- [pkg/storage/storage.go](mdc:pkg/storage/storage.go) - Storage operations
  - Certificate storage
  - CA storage
  - File system operations
  - Metadata handling

## Data Persistence

- File system storage for easy backup
- JSON metadata for structured data
- PEM format for certificates and keys
- Encrypted private keys
